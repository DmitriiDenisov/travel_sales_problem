# travel_sales_problem

В этом Readme описаны три подхода к решению классической задачи коммивояжёра: метод ветвей и границ, муравьиный алгоритм, и опоясывающий метод (метод шнурка).

## Run tests
```
pytest test_tsp.py
```

## 1. Метод ветвей и границ

Этот метод является общим подходом к решению задач целочисленного программирования, включая задачу коммивояжёра. Идея заключается в построении дерева поиска, где узлы представляют частичные решения, и постепенном сужении области поиска с помощью оценок нижней и верхней границ оптимального решения. Ветвление происходит путём выбора узла и разбиения его на подзадачи (ветви), каждая из которых имеет дополнительные ограничения. Границы для каждой ветви помогают отсеивать те ветви, которые не могут содержать оптимальное решение, тем самым уменьшая объём поиска.
### Алгоритм

#### Инициализация

1. **Подготовка данных**: Задается матрица расстояний между городами.
2. **Начальная оценка**: Вычисляется `initial_bound` — минимально возможная стоимость пути, основанная на сумме минимальных и вторых минимальных расстояний для каждого города, делённой на два.

#### Рекурсивный поиск

1. **Старт**: Алгоритм начинает с исходного города, инициализируя путь и текущую стоимость (`current_cost`).
2. **Расширение пути**: На каждом шаге алгоритм рассматривает добавление всех возможных непосещенных городов в маршрут, рекурсивно исследуя возникающие ветви.
3. **Оценка ветвей**: Для каждой ветви вычисляется обновленная нижняя граница стоимости (`current_bound`), учитывая уже построенный маршрут и минимально возможные стоимости для оставшихся городов.
4. **Отсечение ветвей**: Если сумма текущей стоимости маршрута и оценочной стоимости завершения маршрута превышает уже найденную лучшую стоимость (`best_cost`), данная ветвь исключается из дальнейшего рассмотрения.

#### Определение оптимального маршрута

- Поиск продолжается до тех пор, пока не будут исследованы все возможные маршруты или до тех пор, пока не будет найден маршрут, стоимость которого соответствует `initial_bound` или является наименьшей из рассмотренных.

#### Завершение

- Найденный маршрут с минимальной стоимостью является оптимальным решением задачи коммивояжёра.

Этот алгоритм гарантирует нахождение точного решения задачи, минимизируя общую стоимость пути, и является эффективным инструментом для решения задач оптимизации на графах.


## 2. Муравьиный алгоритм

Муравьиный алгоритм вдохновлён поведением муравьёв в природе, ищущих кратчайший путь от своего гнезда до источника пищи. Муравьи изначально исследуют множество путей случайным образом. Они оставляют феромоны на пройденных тропах, что служит индикатором для других муравьёв при выборе пути. С течением времени, благодаря испарению феромонов и их интенсивному накоплению на более коротких путях, большинство муравьёв начинает следовать за кратчайшим маршрутом. В компьютерных алгоритмах муравьи изучают различные пути между городами, а вероятность выбора каждого пути зависит от количества феромона, что ведёт к появлению оптимального пути как результата коллективного взаимодействия.

### Алгоритм

#### Инициализация

1. **Подготовка данных**: Задается матрица расстояний между городами.
2. **Начальное распределение феромона**: На всех ребрах инициализируется одинаковое количество феромона - среднее по матрице расстояний, умноженное на 10

#### Итерационный процесс

На каждой итерации алгоритма происходит следующее:

1. **Построение маршрутов муравьями**: Каждый муравей строит маршрут, выбирая следующий город с вероятностью, зависящей от количества феромона на ребрах и длины ребра (чем больше феромона и чем короче ребро, тем выше вероятность его выбора).

2. **Обновление феромона**:
   - **Испарение феромона**: Часть феромона на всех ребрах испаряется после каждой итерации, уменьшая его количество. Это предотвращает преждевременную конвергенцию к локальному оптимуму.
   - **Добавление феромона**: Муравьи добавляют феромон на пройденные ребра, увеличивая его количество. Количество добавленного феромона обратно пропорционально длине маршрута муравья — чем короче маршрут, тем больше феромона добавляется.

#### Критерий остановки

Алгоритм повторяется до выполнения критерия остановки, который задан как фиксированное количество итераций

#### Результат

По завершении работы алгоритма наиболее предпочтительные пути содержат больше феромона, что указывает на оптимальные или приближенно оптимальные маршруты решения задачи коммивояжёра.

Алгоритм муравьиной колонии особенно хорош в решении комбинаторных оптимизационных задач, таких как задача коммивояжёра, благодаря своей способности эффективно исследовать пространство поиска и адаптироваться к изменениям в процессе поиска решения.


## 3. Опоясывающий метод (или метод шнурка)

Этот метод — более простой и наглядный, и часто используется как эвристический подход. Идея заключается в выборе начальной точки (города), а затем последовательном соединении её с ближайшим непосещённым городом, пока не будут посещены все города. По сути, алгоритм "опоясывает" точки, постепенно расширяя маршрут и минимизируя общую длину пути. Это напоминает метод, при котором вы натягиваете шнур вокруг гвоздей, вбитых в доску по контуру страны или другой фигуры, чтобы получить приближенное изображение её границ.

### Алгоритм

#### Инициализация

1. **Подготовка данных**: Имеется набор точек (городов) на плоскости, заданных их координатами.
2. **Выбор начальной точки**: Определяется начальная точка маршрута. Это может быть город с наименьшей x-координатой (западная крайняя точка) или любая другая точка по выбору.

#### Построение опоясывающего маршрута

1. **Построение конвексной оболочки**: Сначала строится конвексная оболочка для всего набора точек, которая формирует внешний слой "опоясывания".
2. **Удаление внутренних точек и построение следующей оболочки**: Внутренние точки, попавшие внутрь конвексной оболочки, исключаются из дальнейшего рассмотрения, и процесс повторяется для оставшихся точек.
3. **Итеративное сужение**: Процесс повторяется, пока не останется точек, или пока не будет построена последняя конвексная оболочка для оставшихся точек.

#### Соединение оболочек

1. **Определение точек соединения между оболочками**: Для каждой пары последовательных оболочек определяются точки соединения, минимизирующие длину пути между оболочками.
2. **Соединение оболочек**: Построенные оболочки соединяются выбранными точками соединения, формируя непрерывный маршрут.

#### Результат

- Полученный маршрут представляет собой приближенное решение задачи коммивояжёра, минимизируя общую длину пути при посещении всех заданных точек (городов).


